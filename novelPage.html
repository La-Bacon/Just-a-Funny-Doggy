<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>untitle</title>
    <style>
        #novel-content {
            white-space: pre-wrap; /* 改行を維持 */
            font-family: monospace;
        }
        #page-number {
            display: inline-block;
            margin: 0 10px;
        }
    </style>
</head>
<body>

    <div id="novel-content"></div>
    <button id="prev-page">前のページ</button>
    <span id="page-number"></span>
    <button id="next-page">次のページ</button>
    <li><a href="./Text/novel.txt">Test</a></li>

    <script>
        let currentPage = 0;
        let pages = [];
        let pageNumbers = [];

        // テキストファイルを読み込む
        fetch('./Text/novel.txt')
            .then(response => response.text())
            .then(data => {
                // 「＝ページ番号＝」でページを分割
                const pageRegex = /=\d+=/g;
                let matches;
                let lastIndex = 0;
                
                // 各ページを抽出し、ページ番号も記憶する
                while ((matches = pageRegex.exec(data)) !== null) {
                    const pageNumber = matches[0].replace(/=/g, ''); // ページ番号を取得
                    const pageContent = data.slice(lastIndex, matches.index).trim();
                    
                    if (pageContent) {
                        pages.push(pageContent); // ページ内容を保存
                    }
                    pageNumbers.push(pageNumber); // ページ番号を保存
                    lastIndex = pageRegex.lastIndex;
                }

                // 最後のページも保存
                if (lastIndex < data.length) {
                    pages.push(data.slice(lastIndex).trim());
                }

                showPage(currentPage);
            });

        // ページを表示する関数
        function showPage(page) {
            document.getElementById('novel-content').innerHTML = pages[page]; // ページ内容を表示
            document.getElementById('page-number').textContent = `＝${pageNumbers[page]}＝`; // ページ番号を表示
        }

        // 次のページ
        document.getElementById('next-page').addEventListener('click', function() {
            if (currentPage < pages.length - 1) {
                currentPage++;
                showPage(currentPage);
            }
        });

        // 前のページ
        document.getElementById('prev-page').addEventListener('click', function() {
            if (currentPage > 0) {
                currentPage--;
                showPage(currentPage);
            }
        });
    </script>

</body>
</html>
